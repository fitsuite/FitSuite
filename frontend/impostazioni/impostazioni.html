<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Impostazioni | FitSuite</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="./impostazioni.css">
    <link rel="stylesheet" href="../templates/sidebar/sidebar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../components/loading_screen/loading_screen.css">
    <link rel="icon" type="image/x-icon" href="../../image/logo.ico">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCEgbB9rBBKOov3aDma0DMn-EuU0bGMMYo",
        authDomain: "fitsuite-a7b6c.firebaseapp.com",
        projectId: "fitsuite-a7b6c",
        storageBucket: "fitsuite-a7b6c.firebasestorage.app",
        messagingSenderId: "721614273457",
        appId: "1:721614273457:web:195f48279fafd01a1f5b90",
        measurementId: "G-W4ME455MH5"
      };
      firebase.initializeApp(firebaseConfig);
    </script>
    <script src="../cache_manager.js"></script>
</head>
<body class="settings-body">
    <script src="../components/loading_screen/loading_screen.js"></script>
    <div class="app-container">
        <!-- Sidebar -->
        <div id="sidebar-placeholder"></div>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h1>Impostazioni</h1>
                <button class="logout-btn" id="logout-trigger">Log out</button>
            </header>

            <div class="settings-container">
                <div class="user-profile-large">
                    <div class="user-avatar-large" id="user-initial-main">U</div>
                    <div class="user-email-main" id="user-email-main">mario_rossi59@gmail.com</div>
                </div>

                <!-- Account Section -->
                <section class="settings-card glow-card">
                    <h2 class="card-title">Account</h2>
                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-lock row-icon"></i>
                            <div>
                                <span class="row-label">Password</span>
                                <span class="row-value">**********</span>
                            </div>
                        </div>
                        <button class="card-btn" id="change-password-btn">Cambia Password</button>
                    </div>
                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-phone row-icon"></i>
                            <div>
                                <span class="row-label">Numero di telefono</span>
                                <span class="row-value" id="user-phone">+39 224 124 6747</span>
                            </div>
                        </div>
                        <button class="card-btn" id="change-phone-btn">Cambia Telefono</button>
                    </div>
                    <div class="card-footer-action">
                        <p class="action-hint">Se procedi con l'eliminazione dell'account, perderai tutti i tuoi dati</p>
                        <button class="delete-account-btn-styled" id="delete-account-trigger">Elimina Account</button>
                    </div>
                </section>

                <!-- Preferenze Section -->
                <section class="settings-card glow-card">
                    <h2 class="card-title">Preferenze</h2>
                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-palette row-icon"></i>
                            <div>
                                <span class="row-label">Colori</span>
                                <span class="row-value" id="current-color">Arancione</span>
                            </div>
                        </div>
                        <div class="color-options">
                            <span class="color-dot orange active"></span>
                            <span class="color-dot green"></span>
                            <span class="color-dot blue"></span>
                            <span class="color-dot pink"></span>
                        </div>
                    </div>
                    <div class="card-row">
                        <div class="row-info">
                            <span id="language-flag-icon" class="row-icon"></span>
                            <div>
                                <span class="row-label">Lingua predefinita esercizi</span>
                                <span class="row-value" id="user-language">Italiano</span>
                            </div>
                        </div>
                        <button class="card-btn" id="change-language-btn">Cambia Preferenze</button>
                    </div>
                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-bell row-icon"></i>
                            <div>
                                <span class="row-label">Comunicazioni offerte e novitÃ </span>
                                <span class="row-value" id="user-notifications">Consenti tutti</span>
                            </div>
                        </div>
                        <button class="card-btn" id="change-notifications-btn">Cambia Preferenze</button>
                    </div>
                </section>

                <!-- Abbonamento Section -->
                <section class="settings-card glow-card">
                    <h2 class="card-title">Abbonamento</h2>
                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-calendar-alt row-icon"></i>
                            <div>
                                <span class="row-label">Scadenza Abbonamento</span>
                                <span class="row-value" id="subscription-expiry">24/12/2024</span>
                            </div>
                        </div>
                        <button class="card-btn card-btn-edit" id="edit-subscription-expiry">Modifica</button>
                    </div>
                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-credit-card row-icon"></i>
                            <div>
                                <span class="row-label">Metodo di Pagamento</span>
                                <span class="row-value" id="payment-method">**** **** **** 1234</span>
                            </div>
                        </div>
                        <button class="card-btn card-btn-edit" id="edit-payment-method">Modifica</button>
                    </div>
                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-history row-icon"></i>
                            <div>
                                <span class="row-label">Storico Fatturazione</span>
                            </div>
                        </div>
                        <button class="card-btn primary" id="view-billing-history-btn">Visualizza</button>
                    </div>
                    <div class="card-footer-action">
                        <button class="delete-account-btn-styled" id="cancel-subscription-btn">Annulla Abbonamento</button>
                    </div>
                </section>

                <!-- Supporto Section -->
                <section class="settings-card glow-card">
                    <h2 class="card-title">Supporto</h2>
                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-envelope row-icon"></i>
                            <div>
                                <span class="row-label">E-mail assistenza</span>
                                <span class="row-value">Fitsuite.company@gmail.com</span>
                            </div>
                        </div>
                        <button class="card-btn primary" id="contact-us-btn">Contattaci</button>
                    </div>

                    <div class="card-row">
                        <div class="row-info">
                            <i class="fas fa-comment-alt row-icon"></i>
                            <div>
                                <span class="row-label">Dacci la tua opinione</span>
                                <span class="row-value">Come possiamo migliorare?</span>
                            </div>
                        </div>
                        <button class="card-btn primary" id="give-feedback-btn">Dicci la Tua!</button>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Modal di conferma eliminazione -->
    <div id="delete-confirm-modal" class="modal">
        <div class="modal-content">
            <h3>Sei sicuro?</h3>
            <p>Questa azione non puÃ² essere annullata. Tutti i tuoi dati verranno eliminati permanentemente.</p>
            <div class="modal-actions">
                <button id="cancel-delete" class="modal-btn-secondary">Annulla</button>
                <button id="confirm-delete" class="modal-btn-danger">SÃ¬, elimina</button>
            </div>
        </div>
    </div>

    <!-- Modal di modifica abbonamento -->
    <div id="subscription-edit-modal" class="modal">
        <div class="modal-content">
            <h3>Modifica Abbonamento</h3>
            <div class="modal-form-group">
                <label for="subscription-type">Tipo di Abbonamento:</label>
                <select id="subscription-type" class="modal-input">
                    <option value="Nessuno">Nessuno</option>
                    <option value="Base">Base</option>
                    <option value="Premium">Premium</option>
                    <option value="VIP">VIP</option>
                </select>
            </div>
            <div class="modal-form-group">
                <label for="subscription-start-date">Data Inizio:</label>
                <input type="date" id="subscription-start-date" class="modal-input">
            </div>
            <div class="modal-form-group">
                <label for="subscription-end-date">Data Scadenza:</label>
                <input type="date" id="subscription-end-date" class="modal-input">
            </div>
            <div class="modal-form-group">
                <label for="payment-method-input">Metodo di Pagamento:</label>
                <input type="text" id="payment-method-input" class="modal-input" placeholder="Es. **** **** **** 1234">
            </div>
            <div class="modal-form-group">
                <label for="auto-renew-input">Rinnovo Automatico:</label>
                <input type="checkbox" id="auto-renew-input" class="modal-checkbox">
            </div>
            <div class="modal-form-group">
                <label for="last-payment-date-input">Ultimo Pagamento:</label>
                <input type="date" id="last-payment-date-input" class="modal-input">
            </div>
            <div class="modal-form-group">
                <label for="next-payment-date-input">Prossimo Pagamento:</label>
                <input type="date" id="next-payment-date-input" class="modal-input">
            </div>
            <div class="modal-actions">
                <button id="cancel-subscription-edit" class="modal-btn-secondary">Annulla</button>
                <button id="save-subscription-changes" class="modal-btn-primary">Salva</button>
            </div>
        </div>
    </div>

    <!-- Modale per Cambia Password -->
    <div id="change-password-modal" class="modal">
        <div class="modal-content">
            <h3>Cambia Password</h3>
            <p>Ti invieremo un'email per reimpostare la tua password all'indirizzo associato al tuo account.</p>
            <div class="modal-actions">
                <button id="cancel-password-change" class="modal-btn-secondary">Annulla</button>
                <button id="send-password-reset-email" class="modal-btn-primary">Invia Email</button>
            </div>
        </div>
    </div>

    <!-- Modale per Cambia Telefono -->
    <div id="change-phone-modal" class="modal">
        <div class="modal-content">
            <h3>Cambia Numero di Telefono</h3>
            <p>Inserisci il nuovo numero di telefono:</p>
            <input type="tel" id="new-phone-input" placeholder="+39 123 456 7890" class="modal-input">
            <div class="modal-actions">
                <button id="cancel-phone-change" class="modal-btn-secondary">Annulla</button>
                <button id="confirm-phone-change" class="modal-btn-primary">Conferma</button>
            </div>
        </div>
    </div>

    <!-- Modale per Cambia Lingua -->
    <div id="change-language-modal" class="modal">
        <div class="modal-content">
            <h3>Seleziona Lingua</h3>
            <div class="language-options">
                <button class="lang-option modal-btn-primary" data-lang="Italiano">ðŸ‡®ðŸ‡¹ Italiano</button>
                <button class="lang-option modal-btn-primary" data-lang="English">ðŸ‡¬ðŸ‡§ English</button>
            </div>
            <div class="modal-actions">
                <button id="cancel-language-change" class="modal-btn-secondary">Annulla</button>
            </div>
        </div>
    </div>

    <!-- Modale per Cambia Notifiche -->
    <div id="change-notifications-modal" class="modal">
        <div class="modal-content">
            <h3>Gestisci Notifiche</h3>
            <p>Seleziona le tue preferenze per le comunicazioni:</p>
            <div class="notification-options">
                <label><input type="radio" name="notifications" value="Consenti tutti" checked> Consenti tutti</label>
                <label><input type="radio" name="notifications" value="Solo importanti"> Solo importanti</label>
                <label><input type="radio" name="notifications" value="Nessuna"> Nessuna</label>
            </div>
            <div class="modal-actions">
                <button id="cancel-notifications-change" class="modal-btn-secondary">Annulla</button>
                <button id="confirm-notifications-change" class="modal-btn-primary">Salva</button>
            </div>
        </div>
    </div>

    <!-- Modale per Contattaci -->
    <div id="contact-us-modal" class="modal">
        <div class="modal-content">
            <h3>Contattaci</h3>
            <p>Per assistenza, invia una mail a:</p>
            <p><a href="mailto:Fitsuite.company@gmail.com" class="email-link">Fitsuite.company@gmail.com</a></p>
            <div class="modal-actions">
                <button id="close-contact-modal" class="modal-btn-primary">Chiudi</button>
            </div>
        </div>
    </div>

    <!-- Modale per Dicci la Tua! -->
    <div id="give-feedback-modal" class="modal">
        <div class="modal-content">
            <h3>Dicci la Tua!</h3>
            <p>Aiutaci a migliorare. Lascia il tuo feedback:</p>
            <textarea id="feedback-text" class="modal-textarea" placeholder="Scrivi qui il tuo feedback..."></textarea>
            <div class="modal-actions">
                <button id="cancel-feedback" class="modal-btn-secondary">Annulla</button>
                <button id="submit-feedback" class="modal-btn-primary">Invia Feedback</button>
            </div>
        </div>
    </div>

    <!-- Modale per Storico Fatturazione -->
    <div id="billing-history-modal" class="modal">
        <div class="modal-content">
            <h3>Storico Fatturazione</h3>
            <p>Qui potrai visualizzare lo storico delle tue fatture.</p>
            <!-- Contenuto dinamico per lo storico fatturazione -->
            <div class="modal-actions">
                <button id="close-billing-history-modal" class="modal-btn-primary">Chiudi</button>
            </div>
        </div>
    </div>

    <!-- Modale di conferma Logout -->
    <div id="logout-confirm-modal" class="modal">
        <div class="modal-content">
            <h3>Conferma Log out</h3>
            <p>Sei sicuro di voler effettuare il log out?</p>
            <div class="modal-actions">
                <button id="cancel-logout" class="modal-btn-secondary">Annulla</button>
                <button id="confirm-logout" class="modal-btn-danger">Log out</button>
            </div>
        </div>
    </div>

    <script src="../templates/sidebar/sidebar.js"></script>
    <script src="./impostazioni.js"></script>
    <script>
        // Load sidebar.html into the sidebar-placeholder div
        fetch('../templates/sidebar/sidebar.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('sidebar-placeholder').innerHTML = html;
            })
            .catch(err => console.error('Error loading sidebar:', err));
    </script>
</body>
</html>