<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizza Scheda</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="./visualizza_schede.css">
    <link rel="stylesheet" href="../templates/sidebar/sidebar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../components/loading_screen/loading_screen.css">
    <link rel="stylesheet" href="../components/session_control/session_control.css">
    <link rel="stylesheet" href="../components/popup/popup.css">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-storage-compat.js"></script>
    <script src="../config.js"></script>
    <script>
      // Initialize Firebase
      if (window.CONFIG && window.CONFIG.FIREBASE) {
        firebase.initializeApp(window.CONFIG.FIREBASE);
      } else {
        console.error("Firebase config not found in window.CONFIG");
      }
    </script>
    <!-- Logout script -->
    <script src="../../backend/function/logout.js"></script>
    <script src="../cache_manager.js"></script>
</head>
<body>
    <script src="../components/loading_screen/loading_screen.js"></script>

    <div class="app-container">
        <!-- Sidebar -->
        <div id="sidebar-placeholder"></div>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h1>Visualizza Scheda</h1>
                <div class="header-right">
                    <button class="edit-btn"><i class="fas fa-pencil-alt"></i> Modifica</button>
                    <button class="share-btn">Condividi <i class="fas fa-chevron-down"></i></button>
                </div>
            </header>
            
            <div class="visualizza-scheda-wrapper">
                <!-- Sezione Intestazione -->
                <div class="card-section">
                    <h3 class="section-label">Intestazione</h3>
                    <div class="header-details">
                        <h2 id="scheda-name">Scheda Andrea</h2>
                        <div class="date-display">
                            <i class="far fa-calendar-alt"></i>
                            <span id="date-range-display">28 dic 2025 - 31 ago 2026</span>
                        </div>
                    </div>
                </div>

                <!-- Container per le Sedute -->
                <div id="sedute-container">
                    <!-- Sedute will be dynamically loaded here -->
                    <div class="card-section seduta-card" data-seduta-id="1">
                        <div class="seduta-header">
                            <div class="seduta-title-container">
                                <h3 class="section-label">Seduta 1</h3>
                            </div>
                        </div>
                        <div class="seduta-exercises-header">
                            <span class="header-col col-name">Esercizio</span>
                            <span class="header-col col-rep">Rep</span>
                            <span class="header-col col-set">Serie</span>
                            <span class="header-col col-rest">Recupero</span>
                            <span class="header-col col-weight">Peso (kg)</span>
                            <span class="header-col col-note">Nota</span>
                            <span class="header-col col-photo">Foto</span>
                        </div>
                        <div class="seduta-content">
                            <div class="exercises-list">
                                <!-- Exercise rows will be dynamically loaded here -->
                                <div class="exercise-row">
                                    <span class="exercise-detail col-name">Panca piana</span>
                                    <span class="exercise-detail col-rep">4</span>
                                    <span class="exercise-detail col-set">8</span>
                                    <span class="exercise-detail col-rest">30 Sec</span>
                                    <span class="exercise-detail col-weight">30 kg</span>
                                    <span class="exercise-detail col-note">Aumentato di 2kg rispetto alla scorsa settimana</span>
                                    <span class="exercise-detail col-photo">
                                        <img src="https://via.placeholder.com/90" alt="Esercizio">
                                    </span>
                                </div>
                                <div class="exercise-row">
                                    <span class="exercise-detail col-name">Panca piana</span>
                                    <span class="exercise-detail col-rep">7</span>
                                    <span class="exercise-detail col-set">8</span>
                                    <span class="exercise-detail col-rest">30 Sec</span>
                                    <span class="exercise-detail col-weight">8 Kg</span>
                                    <span class="exercise-detail col-note">Aumentato di 2kg rispetto alla scorsa settimana</span>
                                    <span class="exercise-detail col-photo">
                                        <img src="https://via.placeholder.com/90" alt="Esercizio">
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Confirmation Modal -->
    <div id="edit-confirm-modal" class="modal">
        <div class="modal-content">
            <h3>Vuoi modificare la scheda?</h3>
            <div class="modal-actions" style="display: flex; gap: 15px; justify-content: center; margin-top: 25px;">
                <button class="modal-btn-secondary" id="cancel-edit-btn">Annulla</button>
                <button class="modal-btn-primary" id="confirm-edit-btn">Modifica</button>
            </div>
        </div>
    </div>

    <script src="../templates/sidebar/sidebar.js"></script>
    <script src="./visualizza_scheda.js"></script>
    <script src="../components/session_control/session_control.js"></script>
    <script src="../components/popup/popup.js"></script>
    <script>
        // Load sidebar.html into the sidebar-placeholder div
        fetch('../templates/sidebar/sidebar.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('sidebar-placeholder').innerHTML = html;
            })
            .catch(error => console.error('Error loading sidebar:', error));
    </script>
</body>
</html>